<div class="sidebar" [class.collapsed]="sidebarService.isCollapsed$ | async">
  <div class="sidebar-header">
    <div class="logo-section">
      <img src="/assets/logos/PIC_Logo-removebg-preview.png" alt="PIC Logo" class="logo">
      <span class="logo-text" *ngIf="!(sidebarService.isCollapsed$ | async)">PIC Certificate</span>
    </div>
  </div>

  <nav class="sidebar-nav">
    <ul class="nav-list">
      <li *ngFor="let item of menuItems" class="nav-item">
        <a
          *ngIf="!item.children"
          [routerLink]="item.route"
          class="nav-link"
          [class.active]="isActive(item.route!)">
          <i [class]="item.icon" class="nav-icon"></i>
          <span class="nav-text" *ngIf="!(sidebarService.isCollapsed$ | async)">{{ item.label }}</span>
        </a>

        <div *ngIf="item.children" class="nav-item-group">
          <a
            href="javascript:void(0)"
            class="nav-link nav-link-group"
            (click)="toggleSubmenu(item)">
            <i [class]="item.icon" class="nav-icon"></i>
          <span class="nav-text" *ngIf="!(sidebarService.isCollapsed$ | async)">{{ item.label }}</span>
          <i class="fas fa-chevron-down toggle-icon" [class.rotated]="item.isExpanded" *ngIf="!(sidebarService.isCollapsed$ | async)"></i>
          </a>

          <ul class="submenu" [class.expanded]="item.isExpanded">
            <li *ngFor="let child of item.children" class="submenu-item">
              <a
                [routerLink]="child.route"
                class="submenu-link"
                [class.active]="isActive(child.route!)">
                <i [class]="child.icon" class="submenu-icon"></i>
                <span class="submenu-text">{{ child.label }}</span>
              </a>
            </li>
          </ul>
        </div>
      </li>
    </ul>
  </nav>

  <div class="sidebar-footer" *ngIf="currentUser">
    <div class="user-info" *ngIf="!(sidebarService.isCollapsed$ | async)">
      <div class="user-avatar">
        <img [src]="currentUser?.profileImage || '/assets/images/default-profile-icon.png'" [alt]="currentUser?.firstName">
      </div>
      <div class="user-details">
        <span class="user-name">{{ currentUser?.firstName }} {{ currentUser?.lastName }}</span>
        <span class="user-role">{{ currentUser?.role || 'User' }}</span>
      </div>
    </div>
    <button class="logout-btn" (click)="logout()" [title]="(sidebarService.isCollapsed$ | async) ? 'Logout' : ''">
      <i class="fas fa-sign-out-alt"></i>
      <span *ngIf="!(sidebarService.isCollapsed$ | async)">Logout</span>
    </button>
  </div>
</div>
